<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Appendix C: Elevation Data | Point Sensors to Surfaces</title>
  <meta name="description" content="I love documentation! Don’t you? :)" />
  <meta name="generator" content="bookdown 0.20 and GitBook 2.6.7" />

  <meta property="og:title" content="Appendix C: Elevation Data | Point Sensors to Surfaces" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="I love documentation! Don’t you? :)" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Appendix C: Elevation Data | Point Sensors to Surfaces" />
  
  <meta name="twitter:description" content="I love documentation! Don’t you? :)" />
  

<meta name="author" content="Authors Names Here" />


<meta name="date" content="2019-12-19" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="appendix-b-point-emission-data.html"/>

<script src="libs/header-attrs-2.3/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/htmlwidgets-1.5.1/htmlwidgets.js"></script>
<link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-1.3.1/leaflet.js"></script>
<link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="libs/Proj4Leaflet-1.0.1/proj4-compressed.js"></script>
<script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-binding-2.0.3/leaflet.js"></script>
<script src="libs/leaflet-providers-1.9.0/leaflet-providers_1.9.0.js"></script>
<script src="libs/leaflet-providers-plugin-2.0.3/leaflet-providers-plugin.js"></script>
<link href="libs/leaflet-markercluster-1.0.5/MarkerCluster.css" rel="stylesheet" />
<link href="libs/leaflet-markercluster-1.0.5/MarkerCluster.Default.css" rel="stylesheet" />
<script src="libs/leaflet-markercluster-1.0.5/leaflet.markercluster.js"></script>
<script src="libs/leaflet-markercluster-1.0.5/leaflet.markercluster.freezable.js"></script>
<script src="libs/leaflet-markercluster-1.0.5/leaflet.markercluster.layersupport.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#hello-world"><i class="fa fa-check"></i>Hello World!</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="vector-data-mapping.html"><a href="vector-data-mapping.html"><i class="fa fa-check"></i><b>1</b> Vector Data Mapping</a>
<ul>
<li class="chapter" data-level="1.1" data-path="vector-data-mapping.html"><a href="vector-data-mapping.html#required-packages"><i class="fa fa-check"></i><b>1.1</b> Required Packages</a></li>
<li class="chapter" data-level="1.2" data-path="vector-data-mapping.html"><a href="vector-data-mapping.html#political-boundaries"><i class="fa fa-check"></i><b>1.2</b> Political Boundaries</a></li>
<li class="chapter" data-level="1.3" data-path="vector-data-mapping.html"><a href="vector-data-mapping.html#ground-based-data-sensor-locations"><i class="fa fa-check"></i><b>1.3</b> Ground-based Data Sensor Locations</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="vector-data-mapping.html"><a href="vector-data-mapping.html#epa-particulate-matter-sensors"><i class="fa fa-check"></i><b>1.3.1</b> EPA Particulate Matter Sensors</a></li>
<li class="chapter" data-level="1.3.2" data-path="vector-data-mapping.html"><a href="vector-data-mapping.html#weather-stations"><i class="fa fa-check"></i><b>1.3.2</b> Weather Stations</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="vector-data-mapping.html"><a href="vector-data-mapping.html#point-sources-of-pollution"><i class="fa fa-check"></i><b>1.4</b> Point Sources of Pollution</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="data-prep-management.html"><a href="data-prep-management.html"><i class="fa fa-check"></i><b>2</b> Data Prep &amp; Management</a>
<ul>
<li class="chapter" data-level="2.1" data-path="data-prep-management.html"><a href="data-prep-management.html#epa-pollution-data"><i class="fa fa-check"></i><b>2.1</b> EPA Pollution Data</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="data-prep-management.html"><a href="data-prep-management.html#getting-started"><i class="fa fa-check"></i><b>2.1.1</b> Getting Started</a></li>
<li class="chapter" data-level="2.1.2" data-path="data-prep-management.html"><a href="data-prep-management.html#pm2.5-data-query"><i class="fa fa-check"></i><b>2.1.2</b> PM2.5 Data Query</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="data-prep-management.html"><a href="data-prep-management.html#faa-weather-data"><i class="fa fa-check"></i><b>2.2</b> FAA Weather Data</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="data-prep-management.html"><a href="data-prep-management.html#sample-query"><i class="fa fa-check"></i><b>2.2.1</b> Sample Query</a></li>
<li class="chapter" data-level="2.2.2" data-path="data-prep-management.html"><a href="data-prep-management.html#finding-asos-sensors"><i class="fa fa-check"></i><b>2.2.2</b> Finding ASOS Sensors</a></li>
<li class="chapter" data-level="2.2.3" data-path="data-prep-management.html"><a href="data-prep-management.html#weather-data-query"><i class="fa fa-check"></i><b>2.2.3</b> Weather Data Query</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="data-prep-management.html"><a href="data-prep-management.html#introduction"><i class="fa fa-check"></i><b>2.3</b> Introduction</a></li>
<li class="chapter" data-level="2.4" data-path="data-prep-management.html"><a href="data-prep-management.html#loading-the-required-packages"><i class="fa fa-check"></i><b>2.4</b> Loading the Required Packages</a></li>
<li class="chapter" data-level="2.5" data-path="data-prep-management.html"><a href="data-prep-management.html#read-and-examine-the-data"><i class="fa fa-check"></i><b>2.5</b> Read and Examine the Data</a></li>
<li class="chapter" data-level="2.6" data-path="data-prep-management.html"><a href="data-prep-management.html#data-wrangling"><i class="fa fa-check"></i><b>2.6</b> Data Wrangling</a></li>
<li class="chapter" data-level="2.7" data-path="data-prep-management.html"><a href="data-prep-management.html#creating-a-spatial-object-using-sp"><i class="fa fa-check"></i><b>2.7</b> Creating a Spatial Object using sp</a></li>
<li class="chapter" data-level="2.8" data-path="data-prep-management.html"><a href="data-prep-management.html#data-visualization-review"><i class="fa fa-check"></i><b>2.8</b> Data Visualization Review</a></li>
<li class="chapter" data-level="2.9" data-path="data-prep-management.html"><a href="data-prep-management.html#constructing-a-kernal-density-estimation"><i class="fa fa-check"></i><b>2.9</b> Constructing a Kernal Density Estimation</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="example-interpolating-average-temperature-across-the-21-county-study-area-.html"><a href="example-interpolating-average-temperature-across-the-21-county-study-area-.html"><i class="fa fa-check"></i><b>3</b> Example: Interpolating Average Temperature across the 21-county study area.</a>
<ul>
<li class="chapter" data-level="3.1" data-path="example-interpolating-average-temperature-across-the-21-county-study-area-.html"><a href="example-interpolating-average-temperature-across-the-21-county-study-area-.html#wrangling-data"><i class="fa fa-check"></i><b>3.1</b> Wrangling Data</a></li>
<li class="chapter" data-level="3.2" data-path="example-interpolating-average-temperature-across-the-21-county-study-area-.html"><a href="example-interpolating-average-temperature-across-the-21-county-study-area-.html#exploring-the-null-model"><i class="fa fa-check"></i><b>3.2</b> Exploring the Null Model</a></li>
<li class="chapter" data-level="3.3" data-path="example-interpolating-average-temperature-across-the-21-county-study-area-.html"><a href="example-interpolating-average-temperature-across-the-21-county-study-area-.html#model-1-voronoi-model"><i class="fa fa-check"></i><b>3.3</b> Model 1: Voronoi Model</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="example-interpolating-average-temperature-across-the-21-county-study-area-.html"><a href="example-interpolating-average-temperature-across-the-21-county-study-area-.html#validating-the-voronoi-model"><i class="fa fa-check"></i><b>3.3.1</b> Validating the Voronoi Model</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="example-interpolating-average-temperature-across-the-21-county-study-area-.html"><a href="example-interpolating-average-temperature-across-the-21-county-study-area-.html#model-2-nearest-neighbor-interpolation"><i class="fa fa-check"></i><b>3.4</b> Model 2: Nearest Neighbor Interpolation</a></li>
<li class="chapter" data-level="3.5" data-path="example-interpolating-average-temperature-across-the-21-county-study-area-.html"><a href="example-interpolating-average-temperature-across-the-21-county-study-area-.html#model-3-idw-interpolation-using-baseline-parameters"><i class="fa fa-check"></i><b>3.5</b> Model 3: IDW Interpolation using baseline parameters</a></li>
<li class="chapter" data-level="3.6" data-path="example-interpolating-average-temperature-across-the-21-county-study-area-.html"><a href="example-interpolating-average-temperature-across-the-21-county-study-area-.html#model-4-optimized-idw-interpolation"><i class="fa fa-check"></i><b>3.6</b> Model 4: Optimized IDW Interpolation</a></li>
<li class="chapter" data-level="3.7" data-path="example-interpolating-average-temperature-across-the-21-county-study-area-.html"><a href="example-interpolating-average-temperature-across-the-21-county-study-area-.html#model-5-thin-plate-spline-model"><i class="fa fa-check"></i><b>3.7</b> Model 5: Thin Plate Spline Model</a></li>
<li class="chapter" data-level="3.8" data-path="example-interpolating-average-temperature-across-the-21-county-study-area-.html"><a href="example-interpolating-average-temperature-across-the-21-county-study-area-.html#model-6-ordinary-kriging"><i class="fa fa-check"></i><b>3.8</b> Model 6: Ordinary Kriging</a></li>
<li class="chapter" data-level="3.9" data-path="example-interpolating-average-temperature-across-the-21-county-study-area-.html"><a href="example-interpolating-average-temperature-across-the-21-county-study-area-.html#model-7-blending-all-models"><i class="fa fa-check"></i><b>3.9</b> Model 7: Blending all models</a></li>
<li class="chapter" data-level="3.10" data-path="example-interpolating-average-temperature-across-the-21-county-study-area-.html"><a href="example-interpolating-average-temperature-across-the-21-county-study-area-.html#conclusion"><i class="fa fa-check"></i><b>3.10</b> Conclusion</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="merging-satellite-and-point-sensor-data.html"><a href="merging-satellite-and-point-sensor-data.html"><i class="fa fa-check"></i><b>4</b> Merging Satellite and Point Sensor Data</a>
<ul>
<li class="chapter" data-level="4.1" data-path="merging-satellite-and-point-sensor-data.html"><a href="merging-satellite-and-point-sensor-data.html#generate-rasters"><i class="fa fa-check"></i><b>4.1</b> Generate Rasters</a></li>
<li class="chapter" data-level="4.2" data-path="merging-satellite-and-point-sensor-data.html"><a href="merging-satellite-and-point-sensor-data.html#export-to-csv"><i class="fa fa-check"></i><b>4.2</b> Export to CSV</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="appendix-a-ndvi.html"><a href="appendix-a-ndvi.html"><i class="fa fa-check"></i>Appendix A: NDVI</a>
<ul>
<li class="chapter" data-level="4.3" data-path="appendix-a-ndvi.html"><a href="appendix-a-ndvi.html#loading-packages-and-data"><i class="fa fa-check"></i><b>4.3</b> Loading Packages and Data</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="data-manipulation-and-plotting.html"><a href="data-manipulation-and-plotting.html"><i class="fa fa-check"></i><b>5</b> Data manipulation and Plotting</a></li>
<li class="chapter" data-level="6" data-path="more-plotting.html"><a href="more-plotting.html"><i class="fa fa-check"></i><b>6</b> More Plotting!</a></li>
<li class="chapter" data-level="" data-path="appendix-b-point-emission-data.html"><a href="appendix-b-point-emission-data.html"><i class="fa fa-check"></i>Appendix B: Point Emission Data</a>
<ul>
<li class="chapter" data-level="6.1" data-path="appendix-a-ndvi.html"><a href="appendix-a-ndvi.html#loading-packages-and-data"><i class="fa fa-check"></i><b>6.1</b> Loading Packages and Data</a></li>
<li class="chapter" data-level="6.2" data-path="appendix-b-point-emission-data.html"><a href="appendix-b-point-emission-data.html#data-manipulation"><i class="fa fa-check"></i><b>6.2</b> Data Manipulation</a></li>
<li class="chapter" data-level="6.3" data-path="appendix-b-point-emission-data.html"><a href="appendix-b-point-emission-data.html#making-point-data-maps"><i class="fa fa-check"></i><b>6.3</b> Making Point Data Maps</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="appendix-c-elevation-data.html"><a href="appendix-c-elevation-data.html"><i class="fa fa-check"></i>Appendix C: Elevation Data</a>
<ul>
<li class="chapter" data-level="6.4" data-path="appendix-a-ndvi.html"><a href="appendix-a-ndvi.html#loading-packages-and-data"><i class="fa fa-check"></i><b>6.4</b> Loading Packages and Data</a></li>
<li class="chapter" data-level="6.5" data-path="appendix-c-elevation-data.html"><a href="appendix-c-elevation-data.html#inspecting-data"><i class="fa fa-check"></i><b>6.5</b> Inspecting Data</a></li>
<li class="chapter" data-level="6.6" data-path="appendix-b-point-emission-data.html"><a href="appendix-b-point-emission-data.html#data-manipulation"><i class="fa fa-check"></i><b>6.6</b> Data Manipulation</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Point Sensors to Surfaces</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="appendix-c-elevation-data" class="section level1 unnumbered">
<h1>Appendix C: Elevation Data</h1>
<p>The goal of this tutorial is to introduce the packages and techniques that are commonly utilized to manipulate raster data and create grid cells. We will use the elevation data of several larges counties in the Midwest as an example, and special emphasis will be placed on introducing the functionalities of the “velox” package.</p>
<div id="loading-packages-and-data" class="section level2" number="6.4">
<h2><span class="header-section-number">6.4</span> Loading Packages and Data</h2>
<p>We start the tutorial by loading the required packages. The packages “sf,” “raster,” “gstat,” and “tmap” are all standard packages widely used in spatial analysis. The package “tidyverse” is great for all kinds of data manipulation, and its application is not limited to spatial data. The only package that is worth special mention the “velox,” which has excellent performance in fast raster data manipulation. Unfortunately, this package is no longer available. For the lack of substitutes, however, we will still utilize the “velox” package in this tutorial.</p>
<p>To install “velox” from archive, we can run the following code.</p>
<div class="sourceCode" id="cb258"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb258-1"><a href="appendix-c-elevation-data.html#cb258-1" aria-hidden="true"></a><span class="kw">library</span>(devtools)</span>
<span id="cb258-2"><a href="appendix-c-elevation-data.html#cb258-2" aria-hidden="true"></a>devtools<span class="op">::</span><span class="kw">install_github</span>(<span class="st">&quot;https://github.com/hunzikp/velox&quot;</span>)</span></code></pre></div>
<p>(Note, you may have to install an installer, such as Xcode, in order to compile the package locally. Some helpful information can be found <a href="https://support.rstudio.com/hc/en-us/articles/200486508-Building-Testing-and-Distributing-Packages">here</a>.)</p>
<div class="sourceCode" id="cb259"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb259-1"><a href="appendix-c-elevation-data.html#cb259-1" aria-hidden="true"></a><span class="kw">library</span>(sf)</span>
<span id="cb259-2"><a href="appendix-c-elevation-data.html#cb259-2" aria-hidden="true"></a><span class="kw">library</span>(tidyverse)</span>
<span id="cb259-3"><a href="appendix-c-elevation-data.html#cb259-3" aria-hidden="true"></a><span class="kw">library</span>(raster)</span>
<span id="cb259-4"><a href="appendix-c-elevation-data.html#cb259-4" aria-hidden="true"></a><span class="kw">library</span>(gstat)</span>
<span id="cb259-5"><a href="appendix-c-elevation-data.html#cb259-5" aria-hidden="true"></a><span class="kw">library</span>(tmap)</span>
<span id="cb259-6"><a href="appendix-c-elevation-data.html#cb259-6" aria-hidden="true"></a><span class="kw">library</span>(velox)</span>
<span id="cb259-7"><a href="appendix-c-elevation-data.html#cb259-7" aria-hidden="true"></a><span class="kw">library</span>(tmap)</span></code></pre></div>
<p>Loading data is the next step. We load the “grid” data (in kilometers), which is named <code>km.grid</code>, the shapefile of large counties, which is named <code>lac</code>, and also the elevation data, which is named <code>lac.elevation</code>.</p>
<div class="sourceCode" id="cb260"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb260-1"><a href="appendix-c-elevation-data.html#cb260-1" aria-hidden="true"></a>km.grid &lt;-<span class="st"> </span><span class="kw">st_read</span>(<span class="st">&quot;../data/Km_Grid&quot;</span>)</span></code></pre></div>
<pre><code>## Reading layer `Km_Grid&#39; from data source `/Users/LorenzMenendez/Desktop/OpenAirQ-toolkit/data/Km_Grid&#39; using driver `ESRI Shapefile&#39;
## Simple feature collection with 29903 features and 1 field
## geometry type:  POLYGON
## dimension:      XY
## bbox:           xmin: -88.78167 ymin: 40.73704 xmax: -86.46887 ymax: 43.19439
## CRS:            4326</code></pre>
<div class="sourceCode" id="cb262"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb262-1"><a href="appendix-c-elevation-data.html#cb262-1" aria-hidden="true"></a>lac &lt;-<span class="st"> </span><span class="kw">st_read</span>(<span class="st">&quot;../data/LargeAreaCounties&quot;</span>)</span></code></pre></div>
<pre><code>## Reading layer `LargeAreaCounties&#39; from data source `/Users/LorenzMenendez/Desktop/OpenAirQ-toolkit/data/LargeAreaCounties&#39; using driver `ESRI Shapefile&#39;
## Simple feature collection with 21 features and 8 fields
## geometry type:  MULTIPOLYGON
## dimension:      XY
## bbox:           xmin: -88.77879 ymin: 40.73641 xmax: -86.46629 ymax: 43.21831
## CRS:            4326</code></pre>
<div class="sourceCode" id="cb264"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb264-1"><a href="appendix-c-elevation-data.html#cb264-1" aria-hidden="true"></a>lac.elevation &lt;-<span class="st"> </span><span class="kw">readRDS</span>(<span class="st">&quot;../data/LAC_Elevation.rds&quot;</span>)</span></code></pre></div>
<p>The elevation data comes from the 3D Elevation Program (3DEP) of United States Geological Survey. One nice thing about this program is that all of its data are available “free of charge and without use restrictions”. If you are interested in learning more about what data are available, feel free to explore this <a href="https://www.usgs.gov/core-science-systems/ngp/3dep/about-3dep-products-services">website</a>.</p>
</div>
<div id="inspecting-data" class="section level2" number="6.5">
<h2><span class="header-section-number">6.5</span> Inspecting Data</h2>
<p>Before we proceed any further, let’s check the resolution of our elevation data first. The resolution is shown in degrees because that is the unit of CRS.</p>
<div class="sourceCode" id="cb265"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb265-1"><a href="appendix-c-elevation-data.html#cb265-1" aria-hidden="true"></a>raster<span class="op">::</span><span class="kw">res</span>(lac.elevation)</span></code></pre></div>
<pre><code>## [1] 0.0002777778 0.0002777778</code></pre>
<p>We can now plot a raster map, as shown below.</p>
<div class="sourceCode" id="cb267"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb267-1"><a href="appendix-c-elevation-data.html#cb267-1" aria-hidden="true"></a><span class="kw">tm_shape</span>(lac.elevation) <span class="op">+</span></span>
<span id="cb267-2"><a href="appendix-c-elevation-data.html#cb267-2" aria-hidden="true"></a><span class="st">  </span><span class="kw">tm_raster</span>(<span class="dt">alpha =</span> <span class="fl">.5</span>) <span class="op">+</span></span>
<span id="cb267-3"><a href="appendix-c-elevation-data.html#cb267-3" aria-hidden="true"></a><span class="st">  </span><span class="kw">tm_shape</span>(lac) <span class="op">+</span></span>
<span id="cb267-4"><a href="appendix-c-elevation-data.html#cb267-4" aria-hidden="true"></a><span class="st">  </span><span class="kw">tm_borders</span>() <span class="op">+</span></span>
<span id="cb267-5"><a href="appendix-c-elevation-data.html#cb267-5" aria-hidden="true"></a><span class="st">  </span><span class="kw">tm_layout</span>(<span class="dt">legend.outside =</span> <span class="ot">TRUE</span>, </span>
<span id="cb267-6"><a href="appendix-c-elevation-data.html#cb267-6" aria-hidden="true"></a>            <span class="dt">main.title =</span> <span class="st">&quot;Elevation of Large Counties in Midwest&quot;</span>, </span>
<span id="cb267-7"><a href="appendix-c-elevation-data.html#cb267-7" aria-hidden="true"></a>            <span class="dt">main.title.size =</span> <span class="fl">1.2</span>)</span></code></pre></div>
</div>
<div id="data-manipulation" class="section level2" number="6.6">
<h2><span class="header-section-number">6.6</span> Data Manipulation</h2>
<p>Raster data manipulation is where the “velox” packages really shines as it contains a large number of functions that you will find useful in handling raster data. For example, <code>aggregate</code> allows users to aggregate a VeloxRaster object to a lower resolution. Another function, <code>crop</code>, as its name suggests, lets you crop a VeloxRaster function. If you want to rasterize a set of polygons, then you can use <code>rasterize</code>. There are many more functions that are of interest in raster data manipulation, but it is impossible to list all of them here. Detailed documentation about this package can be found <a href="https://rdrr.io/cran/velox/api/">here</a>, and you should feel free to explore it at your own pace. In our tutorial, we will mainly be using <code>velox</code> and <code>extract</code>.</p>
<p>First, we call the <code>velox</code> function to convert <code>lac.elevation</code> into a VeloxRaster object. Then we extract the mean value of each grid (km <span class="math inline">\(\times\)</span> km), and we name it <code>km.elecation.vx</code>. Note that “velox” is indeed good at <em>fast</em> raster data manipulation - running the two lines of code takes very little time.</p>
<div class="sourceCode" id="cb268"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb268-1"><a href="appendix-c-elevation-data.html#cb268-1" aria-hidden="true"></a>elevation.vx &lt;-<span class="st"> </span><span class="kw">velox</span>(lac.elevation)</span>
<span id="cb268-2"><a href="appendix-c-elevation-data.html#cb268-2" aria-hidden="true"></a>km.elevation.vx &lt;-<span class="st"> </span>elevation.vx<span class="op">$</span><span class="kw">extract</span>(km.grid, <span class="dt">fun =</span> mean)</span></code></pre></div>
<div class="sourceCode" id="cb269"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb269-1"><a href="appendix-c-elevation-data.html#cb269-1" aria-hidden="true"></a><span class="kw">head</span>(km.elevation.vx)</span></code></pre></div>
<p>Let’s pause for a second and examine the object <code>km.elevation.vx</code>. As we would expect, it is just a list of the averages of each grid cell.</p>
<p>Next, we join this elevation data with <code>km.grid</code>, which we loaded earlier but haven’t touched at all.</p>
<div class="sourceCode" id="cb270"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb270-1"><a href="appendix-c-elevation-data.html#cb270-1" aria-hidden="true"></a>km.grid<span class="op">$</span>Elevation &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(km.elevation.vx) </span></code></pre></div>
<p>##S Plotting Grid Map</p>
<p>With the data ready, we can now plot a graph.</p>
<div class="sourceCode" id="cb271"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb271-1"><a href="appendix-c-elevation-data.html#cb271-1" aria-hidden="true"></a><span class="kw">tm_shape</span>(km.grid) <span class="op">+</span></span>
<span id="cb271-2"><a href="appendix-c-elevation-data.html#cb271-2" aria-hidden="true"></a><span class="st">  </span><span class="kw">tm_fill</span>(<span class="st">&quot;Elevation&quot;</span>) <span class="op">+</span></span>
<span id="cb271-3"><a href="appendix-c-elevation-data.html#cb271-3" aria-hidden="true"></a><span class="st">  </span><span class="kw">tm_layout</span>(<span class="dt">legend.outside =</span> <span class="ot">TRUE</span>, <span class="dt">main.title =</span> <span class="st">&quot;Elevation of Large Counties in Midwest&quot;</span>, <span class="dt">main.title.size =</span> <span class="fl">1.2</span>)</span></code></pre></div>
<p>We now have a nice grid map - we have successfully accomplished the goal of this tutorial. To save the results of all this work, we can use <code>st_write</code> to output a new shapefile.</p>
<div class="sourceCode" id="cb272"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb272-1"><a href="appendix-c-elevation-data.html#cb272-1" aria-hidden="true"></a><span class="kw">st_write</span>(km.grid, <span class="st">&quot;Elevation_Grid.shp&quot;</span>)</span></code></pre></div>
<p>This is the end of the tutorial. The example of the elevation data is not extraordinarily exciting on its own. It is only used to demonstrate the techniques to create grid cells from raster data. The “velox” introduced in this tutorial is sadly no longer available. However, we still recommend trying out this package as its ability to perform fast raster processing is unmatched.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="appendix-b-point-emission-data.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
