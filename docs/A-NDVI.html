<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Appendix A: NDVI | OpenAirQ-Toolkit.utf8</title>
  <meta name="description" content="<span style='color: #982568; font-size:42px'>OpenAirQ Toolkit
</style>" />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="Appendix A: NDVI | OpenAirQ-Toolkit.utf8" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Appendix A: NDVI | OpenAirQ-Toolkit.utf8" />
  
  
  

<meta name="author" content="Developed for the Partnership for Healthy Cities with support from Bloomberg Philathropies. Last Updated : 2020-12-15 on R version 4.0.3 (2020-10-10)" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="A-weatherdata.html"/>
<link rel="next" href="B-Point_Emission_Data.html"/>
<script src="libs/header-attrs-2.5/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.5.3/htmlwidgets.js"></script>
<link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-1.3.1/leaflet.js"></script>
<link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="libs/Proj4Leaflet-1.0.1/proj4-compressed.js"></script>
<script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-binding-2.0.3/leaflet.js"></script>
<script src="libs/leaflet-providers-1.9.0/leaflet-providers_1.9.0.js"></script>
<script src="libs/leaflet-providers-plugin-2.0.3/leaflet-providers-plugin.js"></script>
<link href="libs/leaflet-markercluster-1.0.5/MarkerCluster.css" rel="stylesheet" />
<link href="libs/leaflet-markercluster-1.0.5/MarkerCluster.Default.css" rel="stylesheet" />
<script src="libs/leaflet-markercluster-1.0.5/leaflet.markercluster.js"></script>
<script src="libs/leaflet-markercluster-1.0.5/leaflet.markercluster.freezable.js"></script>
<script src="libs/leaflet-markercluster-1.0.5/leaflet.markercluster.layersupport.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Introduction</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#software-basics"><i class="fa fa-check"></i>Software Basics</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#author-team"><i class="fa fa-check"></i>Author Team</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#acknowledgements"><i class="fa fa-check"></i>Acknowledgements</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="02-vectormapping.html"><a href="02-vectormapping.html"><i class="fa fa-check"></i><b>1</b> Vector Data Mapping</a>
<ul>
<li class="chapter" data-level="1.1" data-path="02-vectormapping.html"><a href="02-vectormapping.html#introduction-1"><i class="fa fa-check"></i><b>1.1</b> Introduction</a></li>
<li class="chapter" data-level="1.2" data-path="02-vectormapping.html"><a href="02-vectormapping.html#environment-setup"><i class="fa fa-check"></i><b>1.2</b> Environment Setup</a></li>
<li class="chapter" data-level="1.3" data-path="02-vectormapping.html"><a href="02-vectormapping.html#county-boundaries"><i class="fa fa-check"></i><b>1.3</b> County Boundaries</a></li>
<li class="chapter" data-level="1.4" data-path="02-vectormapping.html"><a href="02-vectormapping.html#state-boundaries"><i class="fa fa-check"></i><b>1.4</b> State Boundaries</a></li>
<li class="chapter" data-level="1.5" data-path="02-vectormapping.html"><a href="02-vectormapping.html#epa-particulate-matter-stations"><i class="fa fa-check"></i><b>1.5</b> EPA Particulate Matter Stations</a></li>
<li class="chapter" data-level="1.6" data-path="02-vectormapping.html"><a href="02-vectormapping.html#weather-stations"><i class="fa fa-check"></i><b>1.6</b> Weather Stations</a></li>
<li class="chapter" data-level="1.7" data-path="02-vectormapping.html"><a href="02-vectormapping.html#point-sources-of-pollution"><i class="fa fa-check"></i><b>1.7</b> Point Sources of Pollution</a></li>
<li class="chapter" data-level="" data-path="02-vectormapping.html"><a href="02-vectormapping.html#further-resources"><i class="fa fa-check"></i>Further Resources</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="03-rastermapping.html"><a href="03-rastermapping.html"><i class="fa fa-check"></i><b>2</b> Vector Data Mapping</a>
<ul>
<li class="chapter" data-level="2.1" data-path="03-rastermapping.html"><a href="03-rastermapping.html#introduction-2"><i class="fa fa-check"></i><b>2.1</b> Introduction</a></li>
<li class="chapter" data-level="2.2" data-path="03-rastermapping.html"><a href="03-rastermapping.html#environment-setup-1"><i class="fa fa-check"></i><b>2.2</b> Environment Setup</a></li>
<li class="chapter" data-level="2.3" data-path="03-rastermapping.html"><a href="03-rastermapping.html#dataset-1"><i class="fa fa-check"></i><b>2.3</b> &lt;Dataset 1&gt;</a></li>
<li class="chapter" data-level="" data-path="03-rastermapping.html"><a href="03-rastermapping.html#further-resources-1"><i class="fa fa-check"></i>Further Resources</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="04-ToolkitPointsToSurfaces.html"><a href="04-ToolkitPointsToSurfaces.html"><i class="fa fa-check"></i><b>3</b> Point Sensors to Surfaces</a>
<ul>
<li class="chapter" data-level="3.1" data-path="04-ToolkitPointsToSurfaces.html"><a href="04-ToolkitPointsToSurfaces.html#introduction-3"><i class="fa fa-check"></i><b>3.1</b> Introduction</a></li>
<li class="chapter" data-level="3.2" data-path="04-ToolkitPointsToSurfaces.html"><a href="04-ToolkitPointsToSurfaces.html#environment-setup-2"><i class="fa fa-check"></i><b>3.2</b> Environment Setup</a></li>
<li class="chapter" data-level="3.3" data-path="04-ToolkitPointsToSurfaces.html"><a href="04-ToolkitPointsToSurfaces.html#read-and-examine-the-data"><i class="fa fa-check"></i><b>3.3</b> Read and Examine the Data</a></li>
<li class="chapter" data-level="3.4" data-path="04-ToolkitPointsToSurfaces.html"><a href="04-ToolkitPointsToSurfaces.html#data-wrangling"><i class="fa fa-check"></i><b>3.4</b> Data Wrangling</a></li>
<li class="chapter" data-level="3.5" data-path="04-ToolkitPointsToSurfaces.html"><a href="04-ToolkitPointsToSurfaces.html#creating-a-spatial-object-using-sp"><i class="fa fa-check"></i><b>3.5</b> Creating a Spatial Object using sp</a></li>
<li class="chapter" data-level="3.6" data-path="04-ToolkitPointsToSurfaces.html"><a href="04-ToolkitPointsToSurfaces.html#data-visualization-review"><i class="fa fa-check"></i><b>3.6</b> Data Visualization Review</a></li>
<li class="chapter" data-level="3.7" data-path="04-ToolkitPointsToSurfaces.html"><a href="04-ToolkitPointsToSurfaces.html#constructing-a-kernal-density-estimation"><i class="fa fa-check"></i><b>3.7</b> Constructing a Kernal Density Estimation</a></li>
<li class="chapter" data-level="" data-path="04-ToolkitPointsToSurfaces.html"><a href="04-ToolkitPointsToSurfaces.html#further-resources-2"><i class="fa fa-check"></i>Further Resources</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="05-interpmodels.html"><a href="05-interpmodels.html"><i class="fa fa-check"></i><b>4</b> Interpolation Models</a>
<ul>
<li class="chapter" data-level="4.1" data-path="05-interpmodels.html"><a href="05-interpmodels.html#introduction-4"><i class="fa fa-check"></i><b>4.1</b> Introduction</a></li>
<li class="chapter" data-level="4.2" data-path="05-interpmodels.html"><a href="05-interpmodels.html#environment-setup-3"><i class="fa fa-check"></i><b>4.2</b> Environment Setup</a></li>
<li class="chapter" data-level="4.3" data-path="05-interpmodels.html"><a href="05-interpmodels.html#importing-temperature-sensor-data"><i class="fa fa-check"></i><b>4.3</b> Importing Temperature Sensor Data</a></li>
<li class="chapter" data-level="4.4" data-path="05-interpmodels.html"><a href="05-interpmodels.html#interpolating-temperature"><i class="fa fa-check"></i><b>4.4</b> Interpolating Temperature</a>
<ul>
<li class="chapter" data-level="" data-path="05-interpmodels.html"><a href="05-interpmodels.html#voronoi-tesselation"><i class="fa fa-check"></i>Voronoi Tesselation</a></li>
<li class="chapter" data-level="" data-path="05-interpmodels.html"><a href="05-interpmodels.html#nearest-neighbor"><i class="fa fa-check"></i>Nearest Neighbor</a></li>
<li class="chapter" data-level="" data-path="05-interpmodels.html"><a href="05-interpmodels.html#inverse-distance-weighted"><i class="fa fa-check"></i>Inverse Distance Weighted</a></li>
<li class="chapter" data-level="" data-path="05-interpmodels.html"><a href="05-interpmodels.html#idw-optimiziation"><i class="fa fa-check"></i>IDW Optimiziation</a></li>
<li class="chapter" data-level="" data-path="05-interpmodels.html"><a href="05-interpmodels.html#ordinary-kriging"><i class="fa fa-check"></i>Ordinary Kriging</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="05-interpmodels.html"><a href="05-interpmodels.html#method-selection-criteria"><i class="fa fa-check"></i><b>4.5</b> Method Selection Criteria</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="05-interpmodels.html"><a href="05-interpmodels.html#calculating-rmse"><i class="fa fa-check"></i><b>4.5.1</b> Calculating RMSE</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="05-interpmodels.html"><a href="05-interpmodels.html#further-reading"><i class="fa fa-check"></i>Further Reading</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="09-sensor2raster.html"><a href="09-sensor2raster.html"><i class="fa fa-check"></i><b>5</b> Merging Satellite and Point Sensor Data</a>
<ul>
<li class="chapter" data-level="5.1" data-path="09-sensor2raster.html"><a href="09-sensor2raster.html#generate-rasters"><i class="fa fa-check"></i><b>5.1</b> Generate Rasters</a></li>
<li class="chapter" data-level="5.2" data-path="09-sensor2raster.html"><a href="09-sensor2raster.html#export-to-csv"><i class="fa fa-check"></i><b>5.2</b> Export to CSV</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="A-weatherdata.html"><a href="A-weatherdata.html"><i class="fa fa-check"></i>Appendix A: Pollution &amp; Weather</a>
<ul>
<li class="chapter" data-level="5.3" data-path="A-weatherdata.html"><a href="A-weatherdata.html#epa-pollution-data"><i class="fa fa-check"></i><b>5.3</b> EPA Pollution Data</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="A-weatherdata.html"><a href="A-weatherdata.html#getting-started"><i class="fa fa-check"></i><b>5.3.1</b> Getting Started</a></li>
<li class="chapter" data-level="5.3.2" data-path="A-weatherdata.html"><a href="A-weatherdata.html#pm2.5-data-query"><i class="fa fa-check"></i><b>5.3.2</b> PM2.5 Data Query</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="A-weatherdata.html"><a href="A-weatherdata.html#faa-weather-data"><i class="fa fa-check"></i><b>5.4</b> FAA Weather Data</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="A-weatherdata.html"><a href="A-weatherdata.html#sample-query"><i class="fa fa-check"></i><b>5.4.1</b> Sample Query</a></li>
<li class="chapter" data-level="5.4.2" data-path="A-weatherdata.html"><a href="A-weatherdata.html#finding-asos-sensors"><i class="fa fa-check"></i><b>5.4.2</b> Finding ASOS Sensors</a></li>
<li class="chapter" data-level="5.4.3" data-path="A-weatherdata.html"><a href="A-weatherdata.html#weather-data-query"><i class="fa fa-check"></i><b>5.4.3</b> Weather Data Query</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="A-NDVI.html"><a href="A-NDVI.html"><i class="fa fa-check"></i>Appendix A: NDVI</a>
<ul>
<li class="chapter" data-level="5.5" data-path="A-NDVI.html"><a href="A-NDVI.html#overview"><i class="fa fa-check"></i><b>5.5</b> Overview</a></li>
<li class="chapter" data-level="5.6" data-path="A-NDVI.html"><a href="A-NDVI.html#environment-setup-4"><i class="fa fa-check"></i><b>5.6</b> Environment Setup</a>
<ul>
<li class="chapter" data-level="" data-path="A-NDVI.html"><a href="A-NDVI.html#inputoutput"><i class="fa fa-check"></i>Input/Output</a></li>
<li class="chapter" data-level="" data-path="A-NDVI.html"><a href="A-NDVI.html#load-libraries"><i class="fa fa-check"></i>Load Libraries</a></li>
<li class="chapter" data-level="" data-path="A-NDVI.html"><a href="A-NDVI.html#load-data"><i class="fa fa-check"></i>Load Data</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="A-NDVI.html"><a href="A-NDVI.html#data-manipulation-and-plotting"><i class="fa fa-check"></i><b>5.7</b> Data manipulation and Plotting</a></li>
<li class="chapter" data-level="5.8" data-path="A-NDVI.html"><a href="A-NDVI.html#more-plotting"><i class="fa fa-check"></i><b>5.8</b> More Plotting</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="B-Point_Emission_Data.html"><a href="B-Point_Emission_Data.html"><i class="fa fa-check"></i>Appendix B: Point Emission Data</a>
<ul>
<li class="chapter" data-level="5.9" data-path="B-Point_Emission_Data.html"><a href="B-Point_Emission_Data.html#overview-1"><i class="fa fa-check"></i><b>5.9</b> Overview</a></li>
<li class="chapter" data-level="5.10" data-path="B-Point_Emission_Data.html"><a href="B-Point_Emission_Data.html#environment-setup-5"><i class="fa fa-check"></i><b>5.10</b> Environment Setup</a>
<ul>
<li class="chapter" data-level="" data-path="B-Point_Emission_Data.html"><a href="B-Point_Emission_Data.html#inputoutput-1"><i class="fa fa-check"></i>Input/Output</a></li>
<li class="chapter" data-level="" data-path="B-Point_Emission_Data.html"><a href="B-Point_Emission_Data.html#load-libraries-1"><i class="fa fa-check"></i>Load Libraries</a></li>
<li class="chapter" data-level="" data-path="B-Point_Emission_Data.html"><a href="B-Point_Emission_Data.html#load-data-1"><i class="fa fa-check"></i>Load Data</a></li>
</ul></li>
<li class="chapter" data-level="5.11" data-path="B-Point_Emission_Data.html"><a href="B-Point_Emission_Data.html#data-manipulation"><i class="fa fa-check"></i><b>5.11</b> Data Manipulation</a></li>
<li class="chapter" data-level="5.12" data-path="B-Point_Emission_Data.html"><a href="B-Point_Emission_Data.html#making-point-data-maps"><i class="fa fa-check"></i><b>5.12</b> Making Point Data Maps</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="C-Elevation_Data.html"><a href="C-Elevation_Data.html"><i class="fa fa-check"></i>Appendix C: Elevation Data</a>
<ul>
<li class="chapter" data-level="5.13" data-path="C-Elevation_Data.html"><a href="C-Elevation_Data.html#overview-2"><i class="fa fa-check"></i><b>5.13</b> Overview</a></li>
<li class="chapter" data-level="5.14" data-path="C-Elevation_Data.html"><a href="C-Elevation_Data.html#environment-setup-6"><i class="fa fa-check"></i><b>5.14</b> Environment Setup</a>
<ul>
<li class="chapter" data-level="" data-path="C-Elevation_Data.html"><a href="C-Elevation_Data.html#inputoutput-2"><i class="fa fa-check"></i>Input/Output</a></li>
<li class="chapter" data-level="" data-path="C-Elevation_Data.html"><a href="C-Elevation_Data.html#load-libraries-2"><i class="fa fa-check"></i>Load Libraries</a></li>
<li class="chapter" data-level="5.14.1" data-path="C-Elevation_Data.html"><a href="C-Elevation_Data.html#load-data-2"><i class="fa fa-check"></i><b>5.14.1</b> Load Data</a></li>
</ul></li>
<li class="chapter" data-level="5.15" data-path="C-Elevation_Data.html"><a href="C-Elevation_Data.html#inspecting-data"><i class="fa fa-check"></i><b>5.15</b> Inspecting Data</a></li>
<li class="chapter" data-level="5.16" data-path="C-Elevation_Data.html"><a href="C-Elevation_Data.html#data-manipulation-1"><i class="fa fa-check"></i><b>5.16</b> Data Manipulation</a></li>
<li class="chapter" data-level="5.17" data-path="C-Elevation_Data.html"><a href="C-Elevation_Data.html#plotting-grid-map"><i class="fa fa-check"></i><b>5.17</b> Plotting Grid Map</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="F-Roads_Data.html"><a href="F-Roads_Data.html"><i class="fa fa-check"></i>Appendix F: Roads Data</a>
<ul>
<li class="chapter" data-level="5.18" data-path="F-Roads_Data.html"><a href="F-Roads_Data.html#overview-3"><i class="fa fa-check"></i><b>5.18</b> Overview</a></li>
<li class="chapter" data-level="5.19" data-path="F-Roads_Data.html"><a href="F-Roads_Data.html#environment-setup-7"><i class="fa fa-check"></i><b>5.19</b> Environment Setup</a>
<ul>
<li class="chapter" data-level="" data-path="F-Roads_Data.html"><a href="F-Roads_Data.html#inputoutput-3"><i class="fa fa-check"></i>Input/Output</a></li>
<li class="chapter" data-level="" data-path="F-Roads_Data.html"><a href="F-Roads_Data.html#load-libraries-3"><i class="fa fa-check"></i>Load Libraries</a></li>
<li class="chapter" data-level="" data-path="F-Roads_Data.html"><a href="F-Roads_Data.html#load-data-3"><i class="fa fa-check"></i>Load Data</a></li>
</ul></li>
<li class="chapter" data-level="5.20" data-path="F-Roads_Data.html"><a href="F-Roads_Data.html#data-manipulation-2"><i class="fa fa-check"></i><b>5.20</b> Data Manipulation</a>
<ul>
<li class="chapter" data-level="" data-path="F-Roads_Data.html"><a href="F-Roads_Data.html#prelimnary-work"><i class="fa fa-check"></i>Prelimnary Work</a></li>
<li class="chapter" data-level="" data-path="F-Roads_Data.html"><a href="F-Roads_Data.html#primary-roads"><i class="fa fa-check"></i>Primary Roads</a></li>
<li class="chapter" data-level="" data-path="F-Roads_Data.html"><a href="F-Roads_Data.html#secondary-roads"><i class="fa fa-check"></i>Secondary Roads</a></li>
<li class="chapter" data-level="" data-path="F-Roads_Data.html"><a href="F-Roads_Data.html#motorway"><i class="fa fa-check"></i>Motorway</a></li>
</ul></li>
<li class="chapter" data-level="5.21" data-path="F-Roads_Data.html"><a href="F-Roads_Data.html#outputting-data"><i class="fa fa-check"></i><b>5.21</b> Outputting Data</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./"><span style='color: #982568; font-size:42px'>OpenAirQ Toolkit
</style></a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="appendix-a-ndvi" class="section level1 unnumbered">
<h1>Appendix A: NDVI</h1>
<div id="overview" class="section level2" number="5.5">
<h2><span class="header-section-number">5.5</span> Overview</h2>
<p>In this tutorial, we will learn to deal with raster data. For illustrative purposes, we will take a look at the NDVI data (Normalized Difference Vegetation Index) of 21 large counties in the Midwest. Our objectives are to:</p>
<ul>
<li>Visualize raster data using the “tmap” package</li>
<li>Learn the basic techniques of cropping and masking</li>
<li>Check and analyze summary statistics of raster data</li>
</ul>
</div>
<div id="environment-setup-4" class="section level2" number="5.6">
<h2><span class="header-section-number">5.6</span> Environment Setup</h2>
<div id="inputoutput" class="section level3 unnumbered">
<h3>Input/Output</h3>
<p>Our inputs include the shapefile of 21 large counties in the Midwest and the quarterly data of NDVI. The files are available for download on this project’s <a href="https://github.com/GeoDaCenter/OpenAirQ-toolkit/tree/master/data">GitHub repo</a>.</p>
</div>
<div id="load-libraries" class="section level3 unnumbered">
<h3>Load Libraries</h3>
<p>We will use the following packages in this tutorial:</p>
<ul>
<li><code>raster</code>: to manipulate and analyze raster data</li>
<li><code>sf</code>: to conduct basic spatial data manipulation</li>
<li><code>tamp</code>: to create spatial data visualization</li>
</ul>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="A-NDVI.html#cb97-1" aria-hidden="true"></a><span class="kw">library</span>(raster)</span>
<span id="cb97-2"><a href="A-NDVI.html#cb97-2" aria-hidden="true"></a><span class="kw">library</span>(sf)</span>
<span id="cb97-3"><a href="A-NDVI.html#cb97-3" aria-hidden="true"></a><span class="kw">library</span>(tmap)</span></code></pre></div>
<p>Since we are mainly analyzing raster data in this tutorial, we use the “raster” package heavily, which “implements basic and high-level functions for raster data and for vector data operations such as intersections.” The detailed documentation can be found <a href="https://cran.r-project.org/web/packages/raster/raster.pdf">here</a>.</p>
</div>
<div id="load-data" class="section level3 unnumbered">
<h3>Load Data</h3>
<p>The data we are analyzing is the quarterly average of the Normalized Difference Vegetation Index for 21 large counties in the Midwest, from 2014 to 2018. It is stacked chronologically. Note that the original dataset is quite large (over 50 gigabytes), so we processed the data in advance. We can load the pre-processed data simply by running the command below.</p>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="A-NDVI.html#cb98-1" aria-hidden="true"></a>ndvi.quarterly &lt;-<span class="st"> </span><span class="kw">stack</span>(<span class="st">&quot;./data/NDVILargeAreaQuarterlyStack.tif&quot;</span>)</span></code></pre></div>
<p>(Remark: You may encounter trouble loading the data if you do not have the “rgdal” package installed!)</p>
<p>It is a good idea to take a glance at our dataset before we proceed any further.</p>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="A-NDVI.html#cb99-1" aria-hidden="true"></a>ndvi.quarterly</span></code></pre></div>
<pre><code>## class      : RasterStack 
## dimensions : 1194, 784, 936096, 20  (nrow, ncol, ncell, nlayers)
## resolution : 0.00295, 0.00208  (x, y)
## extent     : -88.77872, -86.46592, 40.73568, 43.2192  (xmin, xmax, ymin, ymax)
## crs        : +proj=longlat +datum=WGS84 +no_defs 
## names      : NDVILarge//rlyStack.1, NDVILarge//rlyStack.2, NDVILarge//rlyStack.3, NDVILarge//rlyStack.4, NDVILarge//rlyStack.5, NDVILarge//rlyStack.6, NDVILarge//rlyStack.7, NDVILarge//rlyStack.8, NDVILarge//rlyStack.9, NDVILarge//lyStack.10, NDVILarge//lyStack.11, NDVILarge//lyStack.12, NDVILarge//lyStack.13, NDVILarge//lyStack.14, NDVILarge//lyStack.15, ... 
## min values :            -0.1979000,            -0.1400464,            -0.1463546,            -0.1714621,            -0.1730933,            -0.1068576,            -0.1513947,            -0.1989500,            -0.1977000,            -0.1508639,            -0.1616515,            -0.1834559,            -0.1792000,            -0.1500082,            -0.1286048, ... 
## max values :             0.4057376,             0.8217609,             0.9162192,             0.7483148,             0.5150092,             0.8381958,             0.9147448,             0.8577355,             0.7820903,             0.8141744,             0.9077643,             0.8238385,             0.8000358,             0.8359118,             0.8964590, ...</code></pre>
<p>Also remember to load the shapfile of the 21 large counties. We will use it shortly when we start plotting.</p>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="A-NDVI.html#cb101-1" aria-hidden="true"></a>counties &lt;-<span class="st"> </span><span class="kw">st_read</span>(<span class="st">&quot;./data/LargeAreaCounties&quot;</span>)</span></code></pre></div>
<pre><code>## Reading layer `LargeAreaCounties&#39; from data source `/Users/LorenzMenendez/Desktop/OpenAirQ-toolkit/data/LargeAreaCounties&#39; using driver `ESRI Shapefile&#39;
## Simple feature collection with 21 features and 8 fields
## geometry type:  MULTIPOLYGON
## dimension:      XY
## bbox:           xmin: -88.77879 ymin: 40.73641 xmax: -86.46629 ymax: 43.21831
## geographic CRS: WGS 84</code></pre>
<p>For more detailed description of the data, please refer to the main chapters of this tutorial book. <strong>Insert Link!</strong></p>
</div>
</div>
<div id="data-manipulation-and-plotting" class="section level2" number="5.7">
<h2><span class="header-section-number">5.7</span> Data manipulation and Plotting</h2>
<p>We start our analysis by looking at the data for one specific quarter - the 3rd quarter of 2018. Since this is the 19th layer of our dataset (recall that our dataset is stacked chronologically), we can easily extract the data using the line of code shown below.</p>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="A-NDVI.html#cb103-1" aria-hidden="true"></a>this.qtr &lt;-<span class="st"> </span>raster<span class="op">::</span><span class="kw">subset</span>(ndvi.quarterly, <span class="dv">19</span>, <span class="dt">drop =</span> <span class="ot">FALSE</span>)</span></code></pre></div>
<p>Thanks to the data processing done beforehand, we don’t have much data manipulation to do. It is time for us to start making plots! We begin with the most basic raster map.</p>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="A-NDVI.html#cb104-1" aria-hidden="true"></a><span class="kw">tm_shape</span>(this.qtr) <span class="op">+</span></span>
<span id="cb104-2"><a href="A-NDVI.html#cb104-2" aria-hidden="true"></a><span class="st">  </span><span class="kw">tm_raster</span>() <span class="op">+</span></span>
<span id="cb104-3"><a href="A-NDVI.html#cb104-3" aria-hidden="true"></a><span class="st">  </span><span class="kw">tm_layout</span>(<span class="dt">legend.outside =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<p>This plot gives an overview of the NDVI of the 21 large counties. Without the county borders explicitly drawn, we are unable to compare the NDVI across counties. Moreover, the plot is far from aesthetically pleasing.</p>
<p>Hence we redraw the graph, this time with counties borders as well as an informative title for the plot. In addition, we modify the title of the legend so that it is more comprehensible to readers.</p>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="A-NDVI.html#cb105-1" aria-hidden="true"></a><span class="kw">tm_shape</span>(this.qtr) <span class="op">+</span></span>
<span id="cb105-2"><a href="A-NDVI.html#cb105-2" aria-hidden="true"></a><span class="st">  </span><span class="kw">tm_raster</span>(<span class="dt">title =</span> <span class="st">&quot;NDVI&quot;</span>) <span class="op">+</span></span>
<span id="cb105-3"><a href="A-NDVI.html#cb105-3" aria-hidden="true"></a><span class="st">  </span><span class="kw">tm_shape</span>(counties) <span class="op">+</span></span>
<span id="cb105-4"><a href="A-NDVI.html#cb105-4" aria-hidden="true"></a><span class="st">  </span><span class="kw">tm_borders</span>() <span class="op">+</span></span>
<span id="cb105-5"><a href="A-NDVI.html#cb105-5" aria-hidden="true"></a><span class="st">  </span><span class="kw">tm_layout</span>(<span class="dt">legend.outside =</span> <span class="ot">TRUE</span>, <span class="dt">main.title =</span> <span class="st">&quot;NDVI - The 3rd Quarter of 2018&quot;</span>)</span></code></pre></div>
<p>With this nicer plot, it is possible to compare the NDVI of different counties. Those who are familiar with the geography of the Midwest would immediately recognize that Cook county seems to have a lower NDVI than other counties. It is not at all surprising since the City of Chicago is located in Cook County, and metropolitan areas tend to have less vegetation than rural areas.</p>
<p>We can also make the plot interactive so that the readers can explore the plot more thoroughly.</p>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="A-NDVI.html#cb106-1" aria-hidden="true"></a><span class="kw">tmap_mode</span>(<span class="st">&quot;view&quot;</span>)</span>
<span id="cb106-2"><a href="A-NDVI.html#cb106-2" aria-hidden="true"></a></span>
<span id="cb106-3"><a href="A-NDVI.html#cb106-3" aria-hidden="true"></a><span class="kw">tm_shape</span>(this.qtr) <span class="op">+</span></span>
<span id="cb106-4"><a href="A-NDVI.html#cb106-4" aria-hidden="true"></a><span class="st">  </span><span class="kw">tm_raster</span>(<span class="dt">title =</span> <span class="st">&quot;NDVI&quot;</span>) <span class="op">+</span></span>
<span id="cb106-5"><a href="A-NDVI.html#cb106-5" aria-hidden="true"></a><span class="st">  </span><span class="kw">tm_shape</span>(counties) <span class="op">+</span></span>
<span id="cb106-6"><a href="A-NDVI.html#cb106-6" aria-hidden="true"></a><span class="st">  </span><span class="kw">tm_borders</span>() <span class="op">+</span></span>
<span id="cb106-7"><a href="A-NDVI.html#cb106-7" aria-hidden="true"></a><span class="st">  </span><span class="kw">tm_layout</span>(<span class="dt">legend.outside =</span> <span class="ot">TRUE</span>, <span class="dt">main.title =</span> <span class="st">&quot;NDVI - the 3rd Quarter of 2018&quot;</span>)</span></code></pre></div>
<p>We can turn off the interactive mode by running the following code.</p>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="A-NDVI.html#cb107-1" aria-hidden="true"></a><span class="kw">tmap_mode</span>(<span class="st">&quot;plot&quot;</span>)</span></code></pre></div>
<p>Before we jump to the next section, it may be helpful to quickly examine the summary statistics for the sub-dataset <code>this.qtr</code>. Notice that we use <code>raster::summary</code> here to specifiy that we want R to use the <code>summary</code> function from the “raster” package.</p>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="A-NDVI.html#cb108-1" aria-hidden="true"></a>raster<span class="op">::</span><span class="kw">summary</span>(this.qtr)</span></code></pre></div>
<pre><code>##         NDVILargeAreaQuarterlyStack.19
## Min.                     -9.315484e-02
## 1st Qu.                   6.263003e-01
## Median                    6.918114e-01
## 3rd Qu.                   7.413675e-01
## Max.                      9.006166e-01
## NA&#39;s                      4.571800e+05</code></pre>
</div>
<div id="more-plotting" class="section level2" number="5.8">
<h2><span class="header-section-number">5.8</span> More Plotting</h2>
<p>Now that we have learned how to make a raster map, let’s make more. In this section, we will place our focus on the NDVI of Cook County, IL - the home county of Chicago. First, we will extract the shape of Cook County.</p>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="A-NDVI.html#cb110-1" aria-hidden="true"></a>cook.county &lt;-<span class="st"> </span>counties[counties<span class="op">$</span>COUNTYNAME <span class="op">==</span><span class="st"> &quot;Cook&quot;</span>, ]</span></code></pre></div>
<p>Before we do anything else, we can plot the shape of Cook County that we just extracted to make sure we subsetted the dataset correctly.</p>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="A-NDVI.html#cb111-1" aria-hidden="true"></a><span class="kw">plot</span>(cook.county<span class="op">$</span>geometry)</span></code></pre></div>
<p><img src="OpenAirQ-Toolkit_files/figure-html/A_Plot%20Cook%20County%20Shape%20ndvi-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>This is a very crude plot since it only shows the border of Cook County. Rest assured that our final product is much more visually pleasing than this!</p>
<p>The following two lines of code crop and mask raster data to Cook County. Cropping and then masking accelerates the actions for large raster data. It probably does not matter in our case, since we are only looking at Cook County, and the volume of our data is rather small.</p>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="A-NDVI.html#cb112-1" aria-hidden="true"></a>cook.ndvi &lt;-<span class="st"> </span>raster<span class="op">::</span><span class="kw">crop</span>(this.qtr, cook.county)</span>
<span id="cb112-2"><a href="A-NDVI.html#cb112-2" aria-hidden="true"></a>cook.ndvi &lt;-<span class="st"> </span>raster<span class="op">::</span><span class="kw">mask</span>(cook.ndvi, cook.county)</span></code></pre></div>
<p>Now we can plot a raster map for Cook County. The commands we use here are very similar to the ones we used before.</p>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="A-NDVI.html#cb113-1" aria-hidden="true"></a><span class="kw">tm_shape</span>(cook.ndvi) <span class="op">+</span></span>
<span id="cb113-2"><a href="A-NDVI.html#cb113-2" aria-hidden="true"></a><span class="st">  </span><span class="kw">tm_raster</span>(<span class="dt">title =</span> <span class="st">&quot;NDVI&quot;</span>, <span class="dt">palette =</span> <span class="st">&quot;Greens&quot;</span>) <span class="op">+</span></span>
<span id="cb113-3"><a href="A-NDVI.html#cb113-3" aria-hidden="true"></a><span class="st">  </span><span class="kw">tm_shape</span>(cook.county) <span class="op">+</span></span>
<span id="cb113-4"><a href="A-NDVI.html#cb113-4" aria-hidden="true"></a><span class="st">  </span><span class="kw">tm_borders</span>() <span class="op">+</span></span>
<span id="cb113-5"><a href="A-NDVI.html#cb113-5" aria-hidden="true"></a><span class="st">  </span><span class="kw">tm_layout</span>(<span class="dt">legend.outside =</span> <span class="ot">TRUE</span>, <span class="dt">main.title =</span> <span class="st">&quot;NDVI for Cook County:</span><span class="ch">\n</span><span class="st">The 3rd Quarter of 2018&quot;</span>)</span></code></pre></div>
<p>With this raster map, we are able to discern patterns of NDVI with Cook County. The middle-east part of Cook County, where the City of Chicago is located, is shown in a lighter green than other parts of the county, signaling a lower NDVI. The northern and southern parts of the county, which are mostly rural areas, are shown to have a higher NDVI, much as we would expect.</p>
<p>Before we conclude this tutorial, let’s again take a look at the summary statistics.</p>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="A-NDVI.html#cb114-1" aria-hidden="true"></a>raster<span class="op">::</span><span class="kw">summary</span>(cook.ndvi)</span></code></pre></div>
<pre><code>##         NDVILargeAreaQuarterlyStack.19
## Min.                      2.923896e-02
## 1st Qu.                   3.955676e-01
## Median                    5.302855e-01
## 3rd Qu.                   6.440714e-01
## Max.                      8.844491e-01
## NA&#39;s                      3.973500e+04</code></pre>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb116-1"><a href="A-NDVI.html#cb116-1" aria-hidden="true"></a>base<span class="op">::</span><span class="kw">mean</span>(<span class="kw">na.omit</span>(<span class="kw">getValues</span>(cook.ndvi))) </span></code></pre></div>
<pre><code>## [1] 0.5213509</code></pre>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb118-1"><a href="A-NDVI.html#cb118-1" aria-hidden="true"></a>base<span class="op">::</span><span class="kw">mean</span>(<span class="kw">na.omit</span>(<span class="kw">getValues</span>(this.qtr))) </span></code></pre></div>
<pre><code>## [1] 0.6662209</code></pre>
<p>The mean NDVI for Cook County is 0.52, while the mean for all 21 counties is 0.67. This is reasonable because NDVI tends to be lower in large cities, and Cook County happens to be at the center of the Chicago metropolitan area. Moreover, this is consistent with what we observe from the plots - Cook County is shown in a lighter green than other counties, which we have pointed out earlier in the tutorial.</p>
<p>This marks the end of our tutorial. Hopefully, now you feel comfortable dealing with raster data. Of course, there are many more techniques to be learned in order to conduct more sophisticated spatial analysis with raster data. There are abundant online resources that introduce more complicated tools to handle raster data, which you may want to explore on your own.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="A-weatherdata.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="B-Point_Emission_Data.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
